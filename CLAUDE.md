# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Common Development Commands

### Build the application
```bash
# Build the main macOS app target
xcodebuild -project soundfiles-explorer.xcodeproj -scheme soundfiles-explorer
```

### Clean build folder
```bash
xcodebuild clean -project soundfiles-explorer.xcodeproj -scheme soundfiles-explorer
```

### Run the app from the command line
```bash
# Launch the app in the default macOS environment
open soundfiles-explorer.xcodeproj
```

### Linting (optional)
The repository currently does not include a Swift lint configuration. If `swiftlint` is installed, you can run:
```bash
swiftlint lint
```

### Run tests
The project has no automated tests defined. If a test target is added later, you can run all tests with:
```bash
xcodebuild test -project soundfiles-explorer.xcodeproj -scheme soundfiles-explorer
```

To run a single test case once a test target exists:
```bash
xcodebuild test \
    -project soundfiles-explorer.xcodeproj \
    -scheme soundfiles-explorer \
    -destination "platform=macOS,arch=x86_64" \
    -only-testing:<TargetName>/<TestName>
```
Replace `<TargetName>` with the test bundle name and `<TestName>` with the specific test method.

## High‑Level Architecture

```
├── soundfiles-explorer.xcodeproj          # Xcode project & scheme
├── soundfiles-explorer/                   # Source package
│   ├── AppDelegate.swift                 # Application life‑cycle
│   ├── MVC.swift                         # Main window view controller
│   ├── src/
│   │   ├── AudioMetadataReader.swift    # BEXT & iXML parsing
│   │   └── ... (future utilities)
│   └── Base.lproj/MainMenu.xib           # Interface Builder layout
└── README.md (if present)
```

### Core Components

| File | Responsibility |
|------|----------------|
| `AppDelegate.swift` | Sets up the main window and responds to application events. |
| `MVC.swift` | Implements `NSViewController`, `NSTableViewDataSource` and `NSTableViewDelegate`. Handles drag‑and‑drop of audio files, populates the table view, and plays audio via `AVPlayerView`. |
| `AudioMetadataReader.swift` | Reads binary WAV/AIF data to extract BEXT and iXML chunks, converting them into `AudioFile`, `BEXTMetadata`, and `IXMLMetadata` structs. It also provides helper methods for parsing timecode and other metadata. |
| `Base.lproj/MainMenu.xib` | Defines the UI layout (table view, search field, player view). |

### Data Flow
1. **Drag‑and‑Drop** – User drops a WAV/AIF file onto the table view.
2. **Metadata Extraction** – `MVC` creates an `AudioMetadataReader`, calls `readAudioMetadata(from:)`, and converts the result into an `AudioFile` object.
3. **Table Population** – The `audioFiles` array is updated, and the table view is refreshed.
4. **Playback** – Selecting a row creates an `AVPlayerItem` and plays the audio.

### Key Types
- `AudioFile`: Holds file name, URL, channel count, bit depth, sample rate, and optional BEXT/IXML metadata.
- `BEXTMetadata` & `IXMLMetadata`: Parsed metadata structures with convenience formatted properties.
- `AudioMetadataReader`: The parser that operates on `Data` using custom binary helpers.

## Notes for Contributors
- Use `xcodebuild` for CI builds; the `soundfiles-explorer` scheme is the main entry point.
- If adding new Swift files, place them under the `src/` directory.
- Keep UI updates in `MVC.swift` or dedicated view‑controller classes; avoid mixing UI and parsing logic.
- All parsing is performed asynchronously in `MVC` using `Task { ... }` to avoid blocking the main thread.
- Follow standard Swift 5 coding style; no explicit linting is enforced but consider adding `swiftlint` if desired.

---

*Generated by Claude Code.*
